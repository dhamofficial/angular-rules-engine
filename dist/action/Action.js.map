{"version":3,"file":"Action.js","sourceRoot":"","sources":["file:///b:/BuildMotionJS/angular-rules-engine/tmp/broccoli_type_script_compiler-input_base_path-TmFTVb7a.tmp/0/src/action/Action.ts"],"names":[],"mappings":"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","sourcesContent":["ï»¿import {ValidationContext} from '../validation/index';\r\nimport {ValidatonContextBase} from '../validation/index';\r\nimport {ValidationContextState} from '../validation/index';\r\nimport {IAction} from './IAction';\r\nimport { ActionResult } from './index';\r\n\r\nexport class Action implements IAction {\r\n    allowExecution = true;\r\n    _validationContext: ValidatonContextBase;\r\n    actionResult: ActionResult = ActionResult.Unknown;\r\n\r\n    constructor() {\r\n        this._validationContext = new ValidationContext();\r\n    }\r\n\r\n    get validationContext(): ValidatonContextBase {\r\n        return this._validationContext;\r\n    }\r\n\r\n    execute() {\r\n        console.log('Preparing to execute action.');\r\n        this.processActionPipeline();\r\n    }\r\n\r\n    processActionPipeline() {\r\n        this.startAction();\r\n        if (this.allowExecution) {\r\n            this.processAction();\r\n        }\r\n        this.finishAction();\r\n    };\r\n\r\n    startAction() {\r\n        console.log('Starting action.');\r\n        this.start();\r\n        this.audit();\r\n        this.preValidateAction();\r\n        this.evaluateRules();\r\n        this.postValidateAction();\r\n        this.preExecuteAction();\r\n    }\r\n\r\n    finishAction() {\r\n        console.log('Finishing action.');\r\n        this.postExecuteAction();\r\n        this.validateActionResult();\r\n        this.finish();\r\n    }\r\n\r\n    processAction() {\r\n        console.log('Processing action.');\r\n        this.performAction();\r\n    }\r\n\r\n    performAction() {\r\n        throw new Error('Not implemented. Requires implementation in concrete action.');\r\n    }\r\n\r\n    start() {\r\n        console.log('Starting action.');\r\n    }\r\n\r\n    audit() {\r\n        console.log('Auditing action.');\r\n    }\r\n\r\n    preValidateAction() {\r\n        console.log('Pre-validating action.');\r\n    }\r\n\r\n    evaluateRules(){\r\n        console.log('Evaluating action rules.');\r\n        let context = this.validateAction();\r\n        if (context.isValid) {\r\n            this.allowExecution = true;\r\n            this.validationContext.state = ValidationContextState.Success;\r\n        } else {\r\n            this.allowExecution = false;\r\n            this.validationContext.state = ValidationContextState.Failure;\r\n        }\r\n    }\r\n\r\n    postValidateAction() {\r\n        console.log('Post-Validation of action.');\r\n    }\r\n\r\n    preExecuteAction() {\r\n        console.log('Pre-execution of action.');\r\n    }\r\n\r\n    postExecuteAction() {\r\n        console.log('Post-execution of action');\r\n    }\r\n\r\n    validateActionResult(): ActionResult {\r\n        throw new Error('Concrete actions required to implement this method.');\r\n    }\r\n\r\n    finish() {\r\n        console.log('Finish action.');\r\n    }\r\n\r\n    validateAction() {\r\n        console.log('Validating the action.');\r\n        return this.validationContext;\r\n    }\r\n}\r\n"]}