{"version":3,"file":"ValidationContext.js","sourceRoot":"","sources":["file:///B:/development/angular-rules-engine/src/validation/ValidationContext.ts"],"names":[],"mappings":";AACA,sBAAqC,SAAS,CAAC,CAAA;AAI/C;;;;;;GAMG;AACH;IAMC;;OAEG;IACH;QARA,UAAK,GAA2B,8BAAsB,CAAC,YAAY,CAAC;QACpE,YAAO,GAAsB,IAAI,KAAK,EAAc,CAAC;QAClD,UAAK,GAAsB,IAAI,KAAK,EAAc,CAAC;QAOrD,OAAO,CAAC,GAAG,CAAC,qFAAqF,CAAC,CAAC;IACpG,CAAC;IAED;;OAEG;IACA,mCAAO,GAAP,UAAQ,IAAgB;QACpB,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;YACd,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QAC9B,CAAC;QACD,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC5B,MAAM,CAAC,IAAI,CAAC;IACb,CAAC;IAEE;;;OAGG;IACH,sCAAU,GAAV,UAAW,MAAc;QACrB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IAED;;OAEG;IACH,uCAAW,GAAX;QAAA,iBAOF;QANA,IAAI,CAAC,OAAO,GAAG,IAAI,KAAK,EAAc,CAAC;QACvC,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;YACzC,MAAM,CAAC,IAAI,CAAC;QACb,CAAC;QACD,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,QAAQ,EAAV,CAAU,CAAC,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC,EAA9B,CAA8B,CAAC,CAAC;QAC9E,MAAM,CAAC,IAAI,CAAC;IACb,CAAC;IAEE;;OAEG;IACN,6CAAiB,GAAjB;QACC,IAAI,aAAa,GAAG,KAAK,CAAC;QAC1B,EAAE,CAAA,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA,CAAC;YACd,IAAI,mBAAmB,GAAG,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,OAAO,KAAK,KAAK,EAAnB,CAAmB,CAAC,CAAC,MAAM,CAAC;YAC3F,EAAE,CAAC,CAAC,mBAAmB,GAAG,CAAC,CAAC,CAAC,CAAC;gBAC7B,aAAa,GAAG,IAAI,CAAC;YACtB,CAAC;QACF,CAAC;QACD,MAAM,CAAC,aAAa,CAAC;IACtB,CAAC;IAMD,sBAAI,sCAAO;QAJR;;;WAGG;aACN;YACC,IAAI,WAAW,GAAY,IAAI,CAAC;YAChC,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;gBAChB,IAAI,iBAAiB,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,OAAO,KAAK,KAAK,EAAnB,CAAmB,CAAC,CAAC,MAAM,CAAC;gBAC3E,EAAE,CAAC,CAAC,iBAAiB,GAAG,CAAC,CAAC,CAAC,CAAC;oBAC3B,WAAW,GAAG,KAAK,CAAC;gBACrB,CAAC;YACF,CAAC;YACD,MAAM,CAAC,WAAW,CAAC;QACpB,CAAC;;;OAAA;IACF,wBAAC;AAAD,CAAC,AAzED,IAyEC;AAzEY,yBAAiB,oBAyE7B,CAAA","sourcesContent":["import {IValidationContext} from './index';\nimport {ValidationContextState} from './index';\nimport {RuleResult} from '../rules/index';\nimport {RulePolicy} from '../rules/index';\n\n/**\n * Use this class to create a new Validation Context for your application. With this\n * context, you can add rules and evaluate the rules.\n *\n * After the rules are evaluated, you can use the Validation Context to determine if there are\n * any rule violations.\n */\nexport class ValidationContext implements IValidationContext {\n\tstate: ValidationContextState = ValidationContextState.NotEvaluated;\n\tresults: Array<RuleResult> = new Array<RuleResult>();\n    rules: Array<RulePolicy> = new Array<RulePolicy>();\n    source: string;\n\n\t/**\r\n\t * The constructor for the base validation context.\r\n\t */\n\tconstructor() {\n\t\tconsole.log('The [ValidationContext] is ready for action(s). All things are good until broken...');\n\t}\n\n\t/**\n\t * Use this method to add a new rule to the ValidationContext. \n\t */\n    addRule(rule: RulePolicy) {\n        if (this.source) {\n            rule.source = this.source;\n        }\n        this.rules.push(rule);\n\t\treturn this;\n\t}\n\n    /**\n     * Use this extension method to set the [Source] for the current validation context.\n     * @param source\n     */\n    withSource(source: string) {\n        this.source = source;\n        return this;\n    }\n\n    /**\n     * Use this method to execute the rules added to the [ValidationContext].\n     */\n    renderRules() {\n\t\tthis.results = new Array<RuleResult>();\n\t\tif (this.rules && this.rules.length < 1) {\n\t\t\treturn this;\n\t\t}\n\t\tthis.rules.sort(r => r.priority).forEach(r => this.results.push(r.execute()));\n\t\treturn this;\n\t}\n\n    /**\n     * Use to determine if the validation context has any rule violations.\n     */\n\thasRuleViolations(): boolean {\n\t\tlet hasViolations = false;\n\t\tif(this.rules){\n\t\t\tlet ruleViolationsCount = this.rules && this.rules.filter(r => r.isValid === false).length;\n\t\t\tif (ruleViolationsCount > 0) {\n\t\t\t\thasViolations = true;\n\t\t\t}\n\t\t}\n\t\treturn hasViolations;\n\t}\n\n    /**\n     * *Use to indicate if the validation context is valid - no rule violations.\n     * @returns {}: returns a boolean.\n     */\n\tget isValid(): boolean {\n\t\tvar isRuleValid: boolean = true;\n\t\tif (this.rules) {\n\t\t\tvar invalidRulesCount = this.rules.filter(r => r.isValid === false).length;\n\t\t\tif (invalidRulesCount > 0) {\n\t\t\t\tisRuleValid = false;\n\t\t\t}\n\t\t}\n\t\treturn isRuleValid;\n\t}\n}\n"]}